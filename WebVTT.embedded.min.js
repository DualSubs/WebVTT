// minify: https://www.digitalocean.com/community/tools/minify
function WebVTT(e){return new class{constructor(e=["milliseconds","timeStamp","singleLine","\n"]){this.name="WebVTT v2.0.0",this.opts=e,this.newLine=this.opts.includes("\n")?"\n":this.opts.includes("\r")?"\r":this.opts.includes("\r\n")?"\r\n":"\n",this.vtt=new String,this.txt=new String,this.json={headers:{},note:[],css:"",body:[]}}parse(e=this.vtt){const t=this.opts.includes("milliseconds")?/^((?<srtNum>\d+)(\r\n|\r|\n))?(?<timeLine>(?<startTime>[0-9:.,]+) --> (?<endTime>[0-9:.,]+)) ?(?<options>.+)?[^](?<text>[\s\S]*)?$/:/^((?<srtNum>\d+)(\r\n|\r|\n))?(?<timeLine>(?<startTime>[0-9:]+)[0-9.,]+ --> (?<endTime>[0-9:]+)[0-9.,]+) ?(?<options>.+)?[^](?<text>[\s\S]*)?$/,i=e.split(/\r\n\r\n|\r\r|\n\n/),n={headers:{},note:[],style:"",body:[]};return i.forEach(((e,i)=>{switch((e=e.trim()).substring(0,5).trim()){case"WEBVT":{let t=e.split(/\r\n|\r|\n/);$.log(`ðŸš§ ${$.name}`,`array: ${t}`),n.headers.type=t.shift(),n.headers.options=t;break}case"NOTE":{let t=e.split(/\r\n|\r|\n/);$.log(`ðŸš§ ${$.name}`,`array: ${t}`),n.note=t;break}case"STYLE":n.style=e;break;default:n.body[i]=e.match(t)?.groups??void 0}})),n.body=n.body.filter(Boolean),n.body=n.body.map(((e,t)=>{if(e.index=t,"WEBVTT"!==n.headers?.type&&(e.timeLine=e.timeLine.replace(",","."),e.startTime=e.startTime.replace(",","."),e.endTime=e.endTime.replace(",",".")),this.opts.includes("timeStamp")){let t=e.startTime.replace(/(.*)/,"1970-01-01T$1Z");e.timeStamp=this.opts.includes("milliseconds")?Date.parse(t):Date.parse(t)/1e3}return e.text=e.text?.trim()??"_",this.opts.includes("singleLine")?e.text=e.text.replace(/\r\n|\r|\n/," "):this.opts.includes("multiLine")&&(e.text=e.text.split(/\r\n|\r|\n/)),e})),n}stringify(e=this.json){return[e.headers=[e.headers?.type||"",e.headers?.options||""].flat(1/0).join(this.newLine),e.note=(e.note??"").join(this.newLine),e.style=e.style??"",e.body=e.body.map((e=>(Array.isArray(e.text)&&(e.text=e.text.join(this.newLine)),e=`${e.srtNum?e.srtNum+this.newLine:""}${e.timeLine} ${e?.options??""}${this.newLine}${e.text}`))).join(this.newLine+this.newLine)].join(this.newLine+this.newLine).trim()}}(e)}
